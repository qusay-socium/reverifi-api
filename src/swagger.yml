openapi: 3.0.0

info:
  version: 1.0.0
  title: Reverifi API

tags:
  - name: Authentication
    description: Authentication endpoints
  - name: User information
    description: User information endpoints
  - name: Listings
    description: Listings endpoints
  - name: Listing types
    description: Listing types endpoints
  - name: Property types
    description: Property types endpoints
  - name: Roles
    description: Roles endpoints
  - name: Features
    description: Features endpoints
  - name: Upload
    description: Upload endpoints

paths:
  /api/auth/signup:
    post:
      tags:
        - Authentication
      summary: Creates a user.
      description: Sign up user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: xyz@xyz.com
                password:
                  type: string
                  example: x@adek1e$
                name:
                  type: string
                  example: john
                isVerified:
                  type: boolean
                  example: true
                phone:
                  type: string
                  example: 0092xxxxxx

      responses:
        '200':
          description: Token

  /api/auth/login:
    post:
      tags:
        - Authentication
      summary: Login
      description: Login by email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: xyz@xyz.com
                password:
                  type: string
                  example: x@adek1e$

      responses:
        '200':
          description: Token

  /api/users:
    get:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: User information
      description: get user information

      responses:
        '200':
          description: User information

    post:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Create user information
      description: Create user information by token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                address:
                  type: object
                  example:
                    england: london
                website:
                  type: string
                  example: www.england.com
                languages:
                  type: array
                  example:
                    - eng
                    - ar
                serviceAreas:
                  type: array
                  example:
                    - Europe
                socials:
                  type: object
                  example:
                    FB: www.fb.com/england
                aboutMe:
                  type: string
                  example: Broker

      responses:
        '200':
          description: User information related by request body

    patch:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Update user information
      description: Update user information by token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  example:
                    name: name
                userInfo:
                  type: object
                  example:
                    address: address
                company:
                  type: object
                  example:
                    id: 97b07d0e-3e7e-4885-9930-b23db645f45f
                    name: company-name
                    email: email@test.com

      responses:
        '200':
          description: Updated user information

    delete:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Delete user information
      description: Delete user information by token
      responses:
        '200':
          description: Confirmation message for deleting

  /api/users/roles:
    get:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Get user Roles
      description: Get user roles

      responses:
        '200':
          description: Users information

    patch:
      description: Update user roles
      summary: Update user roles
      security:
        - bearerAuth: []
      tags:
        - User information
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                roles:
                  type: array
                  example:
                    - a784ef06-781a-4ea2-9323-eb77a543293a
                    - 695d7d66-135d-437b-b0d8-7fe37e831136
      responses:
        '200':
          description: Confirmation message.

  /api/users/roles/{type}:
    get:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Get agent users
      description: Get agent users
      parameters:
        - in: path
          name: type
          schema:
            type: string
          required: true
          description: type of the user
      responses:
        '200':
          description: Users information

  /api/users/{id}:
    get:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Get user information
      description: Get user information
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: id of the user
      responses:
        '200':
          description: User information

  /api/users/all/{limit}:
    get:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Get users
      description: Get users
      parameters:
        - in: path
          name: limit
          schema:
            type: string
          required: true
          description: limit of the users
        - in: query
          name: name
          schema:
            type: string
          description: name of the user
      responses:
        '200':
          description: Users

  /api/users/invited:
    post:
      security:
        - bearerAuth: []
      tags:
        - User information
      summary: Create a user.
      description: Create a user.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: xyz@xyz.com
                name:
                  type: string
                  example: john
      responses:
        '200':
          description: user info

  /api/listings/{id}:
    get:
      security:
        - bearerAuth: []
      tags:
        - Listings
      summary: Listings data
      description: Get all Listings data
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: id of the user
        - in: query
          name: order
          schema:
            type: string
          description: The order of items to return

      responses:
        '200':
          description: Listings data

    post:
      security:
        - bearerAuth: []
      tags:
        - Listings
      summary: Creating
      description: Create new list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isAgent:
                  type: boolean
                isOwner:
                  type: boolean
                  example: true
                features:
                  type: array
                  example:
                    - d4fa0e2f-4ab8-4673-84a1-911eb73abbbb
                    - 64d16b91-febb-4306-8893-609d706a7678
                overview:
                  type: string
                  example: John listing
                images:
                  type: array
                  example:
                    - image url ...
                    - image url ...
                country:
                  type: string
                  example: New york
                lang:
                  type: string
                  example: 34
                lat:
                  type: string
                  example: 11
                city:
                  type: string
                  example: Albany
                zipCode:
                  type: string
                  example: 12345
                street:
                  type: string
                  example: str 91
                propertyType:
                  type: string
                  example: test
                listingType:
                  type: string
                  example: test
                status:
                  type: string
                  example: test
                propertyCondition:
                  type: string
                  example: test
                address:
                  type: string
                  example: 638 Western Ave, Albany, NY 12203, United States
                offerType:
                  type: string
                  example: sell
                price:
                  type: number
                  example: 1
                bedrooms:
                  type: number
                  example: 1
                fullBathrooms:
                  type: number
                  example: 1
                rooms:
                  type: number
                  example: 1
                garages:
                  type: number
                  example: 1
                partialBathrooms:
                  type: number
                  example: 1
                homeArea:
                  type: object
                  example:
                    ft: 225
                lotArea:
                  type: object
                  example:
                    ft: 225
                lotDimensions:
                  type: object
                  example:
                    ft: 225

      responses:
        '200':
          description: Created company information

  /api/listings/listing/{id}:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: UUID of the list
      tags:
        - Listings
      summary: List information
      description: List information by id
      responses:
        '200':
          description: List information

    patch:
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: UUID of the list
      tags:
        - Listings
      summary: Updating
      description: Update list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isAgent:
                  type: boolean
                isOwner:
                  type: boolean
                  example: true
                features:
                  type: array
                  example:
                    - d4fa0e2f-4ab8-4673-84a1-911eb73abbbb
                    - 64d16b91-febb-4306-8893-609d706a7678
                overview:
                  type: string
                  example: John listing
                images:
                  type: array
                  example:
                    - image url ...
                    - image url ...
                country:
                  type: string
                  example: New york
                lang:
                  type: string
                  example: 34
                lat:
                  type: string
                  example: 11
                city:
                  type: string
                  example: Albany
                zipCode:
                  type: string
                  example: 12345
                street:
                  type: string
                  example: str 91
                propertyType:
                  type: string
                  example: test
                listingType:
                  type: string
                  example: test
                status:
                  type: string
                  example: test
                propertyCondition:
                  type: string
                  example: test
                address:
                  type: string
                  example: 638 Western Ave, Albany, NY 12203, United States
                offerType:
                  type: string
                  example: sell
                price:
                  type: number
                  example: 1
                bedrooms:
                  type: number
                  example: 1
                fullBathrooms:
                  type: number
                  example: 1
                rooms:
                  type: number
                  example: 1
                garage:
                  type: number
                  example: 1
                partialBathrooms:
                  type: number
                  example: 1
                homeArea:
                  type: object
                  example:
                    ft: 225
                lotArea:
                  type: object
                  example:
                    ft: 225
                lotDimensions:
                  type: object
                  example:
                    ft: 225

      responses:
        '200':
          description: Updated company information

    delete:
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: UUID of the list
      tags:
        - Listings
      summary: Delete list
      description: Delete list by token
      responses:
        '200':
          description: Confirmation message for deleting

  /api/listings/featured:
    get:
      tags:
        - Listings
      summary: Featured listings
      description: Get featured listings
      responses:
        '200':
          description: List information

  /api/listings/search:
    get:
      parameters:
        - in: query
          name: key
          schema:
            type: string
          description: Search key
      tags:
        - Listings
      summary: Search listings by city or zip code
      description: Search listings by city or zip code

      responses:
        '200':
          description: Listings data

  /api/listing-types:
    get:
      tags:
        - Listing types
      summary: Listing Types
      description: All Listing Types

      responses:
        '200':
          description: Listing Types

  /api/property-types:
    get:
      tags:
        - Property types
      summary: Property Types
      description: All Property Types

      responses:
        '200':
          description: Property Types

  /api/roles:
    get:
      security:
        - bearerAuth: []
      tags:
        - Roles
      summary: Get Roles
      description: Get roles

      responses:
        '200':
          description: Roles

  /api/features:
    get:
      tags:
        - Features
      summary: Features
      description: All Features
      responses:
        '200':
          description: Features

  /api/schedule/{id}:
    get:
      security:
        - bearerAuth: []
      tags:
        - Schedule
      summary: get the schedule for listing
      description: listing Schedule
      responses:
        '200':
          description: listing Schedule

  /api/schedule:
    patch:
      description: listing Schedule
      summary: Creating or updating a Schedule
      security:
        - bearerAuth: []
      tags:
        - Schedule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                startDate:
                  type: date
                  example: 2022-02-23 16:00:00.117+00
                endDate:
                  type: date
                  example: 2022-02-23 16:00:00.117+00
                days:
                  type: object
                  example:
                    start: 2022-02-23 16:00:00.117+00
                listingId:
                  type: string
                  example: e8bef5e4-83bb-4be0-9288-f5688d46f8d8
      responses:
        '200':
          description: listing Schedule

  /api/schedule/visit/:
    post:
      description: listing Schedule visit
      summary: Creating schedule visit
      security:
        - bearerAuth: []
      tags:
        - Schedule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                dateTime:
                  type: date
                  example: 2022-02-23 16:00:00.117+00
                userId:
                  type: UUID
                  example: d4fa0e2f-4ab8-4673-84a1-911eb73abbbb
                listingId:
                  type: UUID
                  example: e8bef5e4-83bb-4be0-9288-f5688d46f8d8
      responses:
        '200':
          description: listing Schedule

  /api/social-statistics:
    get:
      description: Social Statistics
      summary: Social Statistics
      security:
        - bearerAuth: []
      tags:
        - Social Statistics
      parameters:
        - in: query
          name: userId
          schema:
            type: UUID
          description: user id
        - in: query
          name: listingId
          schema:
            type: UUID
          description: listing id
      responses:
        '200':
          description: Social Statistics

    post:
      description: add Social Statistics
      summary: Social Statistics
      security:
        - bearerAuth: []
      tags:
        - Social Statistics
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: UUID
                  example: 447df28e-9935-4eda-9c6e-93544d5dc56c
                listingId:
                  type: UUID
                  example: b975c3ec-f585-4348-8bc9-0af5743c0635
                type:
                  type: string
                  example: views
      responses:
        '200':
          description: Social Statistics

    patch:
      description: update Social Statistics
      summary: Social Statistics
      security:
        - bearerAuth: []
      tags:
        - Social Statistics
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: UUID
                  example: 447df28e-9935-4eda-9c6e-93544d5dc56c
                listingId:
                  type: UUID
                  example: b975c3ec-f585-4348-8bc9-0af5743c0635
      responses:
        '200':
          description: Social Statistics

  /api/social-statistics/{id}:
    get:
      security:
        - bearerAuth: []
      tags:
        - Social Statistics
      summary: Social Statistics
      description: Get user statistics
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: id of the user
    responses:
      '200':
        description: User Social Statistics

  /api/rating-criteria:
    get:
      security:
        - bearerAuth: []
      tags:
        - Rating criteria
      description: Get Rating criteria
      summary: Get Rating criteria
      responses:
        '200':
          description: Rating criteria

  /api/reviews/{id}:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: UUID of the user
      tags:
        - Reviews
      summary: Reviews
      description: Reviews by id
      responses:
        '200':
          description: Reviews

  /api/reviews:
    post:
      security:
        - bearerAuth: []
      tags:
        - Reviews
      summary: Creating
      description: Create new review
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: UUID
                  example: 447df28e-9935-4eda-9c6e-93544d5dc56c
                review:
                  type: string
                  example: Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                selectedCriteria:
                  type: array
                  example:
                    - 1976dc24-b0a4-45a4-903e-65ec1f1b1701
                    - 787f04ab-eaac-4558-ac9e-c2e33a18a9ab
      responses:
        '200':
          description: Created review

    patch:
      security:
        - bearerAuth: []
      tags:
        - Reviews
      summary: Creating
      description: Create new review
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reviewId:
                  type: UUID
                review:
                  type: string
                  example: Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                selectedCriteria:
                  type: array
                  example:
                    - 1976dc24-b0a4-45a4-903e-65ec1f1b1701
                    - 787f04ab-eaac-4558-ac9e-c2e33a18a9ab
      responses:
        '200':
          description: updated review

  /api/invitations/{type}:
    get:
      security:
        - bearerAuth: []
      tags:
        - Invitations
      summary: invitations
      description: get user invitations
      parameters:
        - in: path
          name: type
          schema:
            type: string
          required: true
          description: type of invitation sent or incoming
      responses:
        '200':
          description: User invitations

  /api/invitations:
    post:
      security:
        - bearerAuth: []
      tags:
        - Invitations
      summary: Add invitations
      description: Add invitations
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIdsAndRoles:
                  type: array
                listingId:
                  type: UUID
                model:
                  type: string
                  example:
                    - listings
                name:
                  type: string
                  example:
                    - transaction
      responses:
        '200':
          description: User invitations

  /api/invitations/{id}:
    patch:
      security:
        - bearerAuth: []
      tags:
        - Invitations
      summary: Update user invitation
      description: Update user invitation
      parameters:
        - in: path
          name: id
          schema:
            type: UUID
          required: true
          description: invitation id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  example: accepted
      responses:
        '200':
          description: Updated user information

  /api/upload:
    post:
      summary: Uploads a file to GC
      tags:
        - Upload
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  parameters:
    page:
      name: page
      in: query
      description: Page number
      required: false
      schema:
        type: integer
        format: int32
        default: 1
    limit:
      name: limit
      in: query
      description: Max items per page
      required: false
      schema:
        type: integer
        format: int32
        default: 30
